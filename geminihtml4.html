<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Radiografía de la Delincuencia en Chile - IDI 2015-2024</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <style>
      :root {
        --dark-blue: #0a2342;
        --mid-blue: #2c5d63;
        --teal: #2ca58d;
        --light-green: #b9e28c;
        --yellow: #f4d35e;
        --red: #d9464f; /* Adjusted Red for better harmony */
        --light-blue: #89c2d9;
        --light-bg: #f8fafc; /* Lighter background */
        --card-bg: #ffffff;
        --text-primary: #1e293b;
        --text-secondary: #475569;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--light-bg);
        color: var(--text-secondary);
      }

      .section-card {
        background: var(--card-bg);
        border-radius: 1.25rem; /* Increased border-radius */
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
        border: 1px solid #e2e8f0;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .section-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
      }
      
      .header-gradient {
        background: linear-gradient(135deg, var(--dark-blue) 0%, var(--mid-blue) 100%);
        color: white;
      }

      .btn-primary {
        background: linear-gradient(to right, var(--teal), var(--mid-blue));
        color: white;
        font-weight: 600;
        padding: 12px 28px;
        border-radius: 12px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 10px rgba(44, 165, 141, 0.25);
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(44, 165, 141, 0.35);
      }
      
      .map-tab {
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: background-color 0.2s, color 0.2s;
        border: 1px solid #d1d5db;
        background-color: #fff;
        color: #374151;
      }
      
      .map-tab.active {
        background-color: var(--dark-blue);
        color: #fff;
        border-color: var(--dark-blue);
      }

      .badge {
        padding: 6px 14px;
        border-radius: 9999px;
        font-size: 0.8rem;
        font-weight: 700;
        line-height: 1;
      }
      
      .badge-high { background-color: rgba(217, 70, 79, 0.1); color: var(--red); border: 1px solid rgba(217, 70, 79, 0.2); }
      .badge-medium { background-color: rgba(44, 93, 99, 0.1); color: var(--mid-blue); border: 1px solid rgba(44, 93, 99, 0.2); }
      .badge-low { background-color: rgba(44, 165, 141, 0.1); color: var(--teal); border: 1px solid rgba(44, 165, 141, 0.2); }

      .styled-select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
        background-position: right 0.7rem center;
        background-repeat: no-repeat;
        background-size: 1.25em 1.25em;
        padding-right: 2.5rem;
      }

      .data-table { width: 100%; border-collapse: separate; border-spacing: 0; }
      .data-table th { background-color: #f8fafc; padding: 14px 18px; text-align: left; font-weight: 600; color: var(--dark-blue); border-bottom: 1px solid #e2e8f0; font-size: 0.9rem; }
      .data-table td { padding: 14px 18px; border-bottom: 1px solid #e2e8f0; font-size: 0.95rem; }
      .data-table tr:last-child td { border-bottom: none; }
      .data-table tr:hover td { background-color: #f8fafc; }

      .ai-analysis-output {
        background: linear-gradient(135deg, rgba(240, 249, 255, 0.5) 0%, rgba(240, 253, 250, 0.5) 100%);
        border: 1px solid #e5e7eb;
        border-radius: 1rem;
        padding: 1.75rem;
        transition: all 0.3s ease;
      }
      .chart-container-ai {
        height: 300px;
        position: relative;
        margin-top: 1rem;
      }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 md:px-6 py-8">
      
      <header class="header-gradient rounded-3xl p-8 md:p-12 mb-12 text-center shadow-lg">
        <div class="max-w-4xl mx-auto">
          <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4 tracking-tight">
            Radiografía de la Delincuencia en Chile
          </h1>
          <p class="text-xl text-blue-200 mb-6">
            Análisis del Índice de Delincuencia Integrado (IDI) 2015-2024
          </p>
          <div class="flex flex-wrap justify-center items-center gap-3">
            <span class="badge badge-high">IDI Nacional: 142.7</span>
            <span class="badge badge-medium">+42.7% vs 2015</span>
            <span class="badge badge-low">Mejor región: Magallanes</span>
          </div>
        </div>
      </header>

      <section class="mb-12">
        <div class="section-card p-6 md:p-10">
          <div class="max-w-4xl mx-auto text-center mb-10">
            <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-4">
              ¿Qué es el IDI?
            </h2>
            <p class="text-lg text-text-secondary leading-relaxed">
              El IDI mide la carga delictual ponderando los crímenes según su gravedad y letalidad. Un índice sobre 100 indica una situación peor que la base nacional de 2015.
            </p>
          </div>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
            <div class="chart-container h-80 md:h-96"><canvas id="ponderadoresChart"></canvas></div>
            <div class="space-y-4">
                <div class="flex items-start p-4 bg-slate-50 rounded-xl">
                    <div class="flex-shrink-0 w-10 h-10 bg-light-blue text-dark-blue rounded-full flex items-center justify-center font-bold text-xl mr-4">1</div>
                    <p class="font-medium text-text-secondary self-center">Se calcula la tasa de 6 delitos de alto impacto por 100.000 habitantes.</p>
                </div>
                <div class="flex items-start p-4 bg-slate-50 rounded-xl">
                    <div class="flex-shrink-0 w-10 h-10 bg-teal text-white rounded-full flex items-center justify-center font-bold text-xl mr-4">2</div>
                    <p class="font-medium text-text-secondary self-center">Cada tasa se multiplica por su ponderador de severidad.</p>
                </div>
                <div class="flex items-start p-4 bg-slate-50 rounded-xl">
                    <div class="flex-shrink-0 w-10 h-10 bg-mid-blue text-white rounded-full flex items-center justify-center font-bold text-xl mr-4">3</div>
                    <p class="font-medium text-text-secondary self-center">Se suman los valores para obtener una Puntuación Bruta.</p>
                </div>
                <div class="flex items-start p-4 bg-slate-50 rounded-xl">
                    <div class="flex-shrink-0 w-10 h-10 bg-dark-blue text-white rounded-full flex items-center justify-center font-bold text-xl mr-4">4</div>
                    <p class="font-medium text-text-secondary self-center">La puntuación se estandariza contra la base nacional (IDI=100).</p>
                </div>
            </div>
          </div>
        </div>
      </section>

      <section class="mb-12">
        <div class="text-center mb-10">
          <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-3">Panorama Regional</h2>
          <p class="text-lg text-text-secondary max-w-3xl mx-auto">La brecha entre las regiones del norte y sur se ha mantenido durante la última década.</p>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="section-card p-6 md:p-8"><h3 class="text-xl font-bold text-text-primary mb-6 text-center">Evolución del IDI en Regiones Clave (2015-2024)</h3><div class="chart-container h-96"><canvas id="tendenciaRegionalChart"></canvas></div></div>
          <div class="section-card p-6 md:p-8"><h3 class="text-xl font-bold text-text-primary mb-6 text-center">Ranking Regional (Promedio IDI 2015-2024)</h3><div class="chart-container h-96"><canvas id="rankingRegionalChart"></canvas></div></div>
        </div>
      </section>
      
      <section class="mb-12">
          <div class="text-center mb-10">
              <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-3">Realidad Comunal: Los Extremos del País</h2>
              <p class="text-lg text-text-secondary max-w-3xl mx-auto">Mientras algunas comunas enfrentan desafíos críticos, otras registran una incidencia de delitos de alto impacto casi nula.</p>
          </div>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
              <div class="section-card">
                  <div class="p-6 flex items-center gap-3 border-b border-gray-200">
                      <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                      <h3 class="text-xl font-bold text-red-600">Top 10 Comunas con Mayor IDI</h3>
                  </div>
                  <div class="overflow-x-auto"><table class="data-table"><thead class="bg-red-50"><tr><th>Comuna</th><th class="text-right">IDI Promedio</th></tr></thead><tbody id="topComunasTable"></tbody></table></div>
              </div>
              <div class="section-card">
                  <div class="p-6 flex items-center gap-3 border-b border-gray-200">
                      <div class="w-3 h-3 bg-teal-500 rounded-full"></div>
                      <h3 class="text-xl font-bold text-teal-600">Top 10 Comunas con Menor IDI</h3>
                  </div>
                  <div class="overflow-x-auto"><table class="data-table"><thead class="bg-teal-50"><tr><th>Comuna</th><th class="text-right">IDI Promedio</th></tr></thead><tbody id="bottomComunasTable"></tbody></table></div>
              </div>
          </div>
      </section>

      <section class="mb-12">
        <div class="section-card p-6 md:p-8">
          <div class="text-center mb-6">
            <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-3">Mapa Interactivo del IDI Comunal</h2>
            <p class="text-lg text-text-secondary max-w-3xl mx-auto">Explora visualmente la distribución del IDI a lo largo de Chile.</p>
          </div>

          <div class="flex justify-center items-center mb-4 p-1 bg-slate-100 rounded-lg max-w-md mx-auto">
              <button id="markerMapTab" class="map-tab active w-1/2">Mapa de Puntos</button>
              <button id="choroplethMapTab" class="map-tab w-1/2">Mapa de Corocletas</button>
          </div>

          <div class="map-controls bg-slate-50/50 rounded-2xl p-4 mb-6 border border-slate-200">
             <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="mapViewSelect" class="block text-sm font-medium text-gray-700 mb-2">Ver mapa por:</label>
                  <select id="mapViewSelect" class="styled-select w-full p-3 bg-white border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                    <option value="idi_average">IDI Promedio (Continuo)</option>
                    <option value="groups">Clasificación por Grupos</option>
                  </select>
                </div>
                <div>
                  <label for="regionMapSelect" class="block text-sm font-medium text-gray-700 mb-2">Filtrar por Región:</label>
                  <select id="regionMapSelect" class="styled-select w-full p-3 bg-white border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                    <option value="all">Todas las Regiones</option>
                  </select>
                </div>
              </div>
          </div>

          <div id="mapContainer" class="w-full h-[600px] rounded-2xl overflow-hidden border border-gray-200 shadow-inner relative">
              <div id="markerMap" class="w-full h-full"></div>
              <div id="choroplethMap" class="w-full h-full hidden"></div>
          </div>
          
          <div id="mapLegend" class="mt-6 p-5 bg-slate-50 rounded-2xl border border-slate-200 hidden">
            <h3 class="text-lg font-bold text-text-primary mb-3">Leyenda de Grupos IDI:</h3>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                <div class="flex items-center"><span class="w-4 h-4 rounded-full mr-2" style="background-color: #d9464f;"></span><span>Críticos (>200)</span></div>
                <div class="flex items-center"><span class="w-4 h-4 rounded-full mr-2" style="background-color: #0a2342;"></span><span>Alta Preocupación</span></div>
                <div class="flex items-center"><span class="w-4 h-4 rounded-full mr-2" style="background-color: #2c5d63;"></span><span>Moderados</span></div>
                <div class="flex items-center"><span class="w-4 h-4 rounded-full mr-2" style="background-color: #2ca58d;"></span><span>Menor Riesgo</span></div>
                <div class="flex items-center"><span class="w-4 h-4 rounded-full mr-2" style="background-color: #b9e28c;"></span><span>Baja Incidencia</span></div>
            </div>
          </div>
        </div>
      </section>

      <section class="mb-12">
        <div class="section-card p-6 md:p-8">
            <div class="text-center mb-8">
              <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-3 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-teal-500" viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z" /></svg>
                Análisis y Recomendaciones con IA
              </h2>
              <p class="text-lg text-text-secondary max-w-3xl mx-auto">Selecciona una región para obtener un análisis de seguridad y recomendaciones generadas por IA.</p>
            </div>
            <div class="max-w-3xl mx-auto">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="md:col-span-2">
                  <label for="regionSelect" class="block text-sm font-medium text-gray-700 mb-2">Selecciona una Región:</label>
                  <select id="regionSelect" class="styled-select w-full p-3 bg-white border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"></select>
                </div>
                <div class="flex items-end">
                  <button id="generateAnalysisBtn" class="btn-primary w-full h-[48px]">
                    <span>Generar Análisis</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                  </button>
                </div>
              </div>
              <div id="analysisOutput" class="ai-analysis-output min-h-[200px] flex flex-col justify-center">
                <p class="text-center text-text-secondary italic">El análisis para la región seleccionada aparecerá aquí.</p>
              </div>
            </div>
        </div>
      </section>

      <section class="mb-12">
        <div class="text-center mb-10">
          <h2 class="text-3xl md:text-4xl font-bold text-text-primary">Conclusiones Clave</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="section-card p-6 border-t-4 border-blue-500"><h3 class="text-lg font-bold text-blue-800 mb-2">Focalización Geográfica</h3><p class="text-text-secondary">La delincuencia se concentra en el norte y la RM, exigiendo políticas de seguridad diferenciadas y recursos focalizados.</p></div>
          <div class="section-card p-6 border-t-4 border-teal-500"><h3 class="text-lg font-bold text-teal-800 mb-2">El Peso de la Violencia</h3><p class="text-text-secondary">La gravedad (calidad) de la delincuencia es más relevante que la cantidad para entender el impacto real en la seguridad.</p></div>
          <div class="section-card p-6 border-t-4 border-green-500"><h3 class="text-lg font-bold text-green-700 mb-2">El Contexto Importa</h3><p class="text-text-secondary">Un IDI alto en Colchane tiene un origen distinto a uno en Santiago, demostrando la necesidad de estrategias contextuales.</p></div>
        </div>
      </section>

      <footer class="text-center mt-16 py-8 text-gray-500 text-sm border-t border-gray-200">
        <p>Fuente de datos: Análisis basado en la metodología del IDI y datos del CEAD (2015-2024).</p>
        <p class="mt-2">Visualización de datos generada con fines informativos. Última actualización: Agosto 2024.</p>
      </footer>
    </div>
    
    <script>
      let merged_commune_data_for_js = [{"comuna":"Aisén","promedioIDI":91.39,"longitud":-73.765003751,"latitud":-45.9833068142,"region":"Aysén"},{"comuna":"Algarrobo","promedioIDI":112.05,"longitud":-71.5993956467,"latitud":-33.3294482337,"region":"Valparaíso"},{"comuna":"Alhué","promedioIDI":65.85,"longitud":-71.0564425064,"latitud":-34.0427291332,"region":"Metropolitana"},{"comuna":"Alto Biobío","promedioIDI":80.56,"longitud":-71.3474499917,"latitud":-37.8654492171,"region":"Biobío"},{"comuna":"Alto Hospicio","promedioIDI":171.11,"longitud":-70.0109621438,"latitud":-20.1899464527,"region":"Tarapacá"},{"comuna":"Alto del Carmen","promedioIDI":29.55,"longitud":-70.1564228881,"latitud":-28.9905003682,"region":"Atacama"},{"comuna":"Ancud","promedioIDI":76.62,"longitud":-73.8013178115,"latitud":-42.0159379209,"region":"Los Lagos"},{"comuna":"Andacollo","promedioIDI":59.21,"longitud":-71.1006377659,"latitud":-30.2594312428,"region":"Coquimbo"},{"comuna":"Angol","promedioIDI":80.44,"longitud":-72.7957142527,"latitud":-37.7687124996,"region":"La Araucanía"},{"comuna":"Antofagasta","promedioIDI":101.24,"longitud":-69.4100886557,"latitud":-24.2767223957,"region":"Antofagasta"},{"comuna":"Antuco","promedioIDI":54.66,"longitud":-71.3670325939,"latitud":-37.3275223478,"region":"Biobío"},{"comuna":"Arauco","promedioIDI":74.17,"longitud":-73.3998060091,"latitud":-37.2885901706,"region":"Biobío"},{"comuna":"Arica","promedioIDI":126.47,"longitud":-69.9714910871,"latitud":-18.5321930844,"region":"Arica y Parinacota"},{"comuna":"Buin","promedioIDI":90.03,"longitud":-70.7389422429,"latitud":-33.7480620996,"region":"Metropolitana"},{"comuna":"Bulnes","promedioIDI":70.42,"longitud":-72.2900215842,"latitud":-36.7904030424,"region":"Ñuble"},{"comuna":"Cabildo","promedioIDI":58.38,"longitud":-70.8235358129,"latitud":-32.4173580824,"region":"Valparaíso"},{"comuna":"Cabo de Hornos","promedioIDI":59.57,"longitud":-69.2676114487,"latitud":-55.0293737697,"region":"Magallanes"},{"comuna":"Cabrero","promedioIDI":65.7,"longitud":-72.3813599006,"latitud":-37.061937188,"region":"Biobío"},{"comuna":"Calama","promedioIDI":118.33,"longitud":-68.6297098246,"latitud":-22.1621189149,"region":"Antofagasta"},{"comuna":"Calbuco","promedioIDI":81.05,"longitud":-73.1948686881,"latitud":-41.722765597,"region":"Los Lagos"},{"comuna":"Caldera","promedioIDI":121.56,"longitud":-70.6821335891,"latitud":-27.1411226941,"region":"Atacama"},{"comuna":"Calera","promedioIDI":73.71,"longitud":-71.157053149,"latitud":-32.7938563874,"region":"Valparaíso"},{"comuna":"Calera de Tango","promedioIDI":91.08,"longitud":-70.7902285336,"latitud":-33.6232505323,"region":"Metropolitana"},{"comuna":"Calle Larga","promedioIDI":57.11,"longitud":-70.544659459,"latitud":-32.9507728238,"region":"Valparaíso"},{"comuna":"Camarones","promedioIDI":112.09,"longitud":-69.7140563923,"latitud":-18.93858957,"region":"Arica y Parinacota"},{"comuna":"Camiña","promedioIDI":53.61,"longitud":-69.5053391192,"latitud":-19.3734498459,"region":"Tarapacá"},{"comuna":"Canela","promedioIDI":40.65,"longitud":-71.3943841986,"latitud":-31.4018389133,"region":"Coquimbo"},{"comuna":"Carahue","promedioIDI":66.49,"longitud":-73.2695568969,"latitud":-38.6112039099,"region":"La Araucanía"},{"comuna":"Cartagena","promedioIDI":158.18,"longitud":-71.4422082117,"latitud":-33.5338143016,"region":"Valparaíso"},{"comuna":"Casablanca","promedioIDI":75.88,"longitud":-71.4349790946,"latitud":-33.3156665372,"region":"Valparaíso"},{"comuna":"Castro","promedioIDI":92.22,"longitud":-73.8046191297,"latitud":-42.4737944023,"region":"Los Lagos"},{"comuna":"Catemu","promedioIDI":56.72,"longitud":-70.9446388023,"latitud":-32.7073168664,"region":"Valparaíso"},{"comuna":"Cauquenes","promedioIDI":62.03,"longitud":-72.2804905385,"latitud":-35.9712438036,"region":"Maule"},{"comuna":"Cañete","promedioIDI":82.33,"longitud":-73.3173011876,"latitud":-37.873666887,"region":"Biobío"},{"comuna":"Cerrillos","promedioIDI":178.38,"longitud":-70.712543579,"latitud":-33.4997666344,"region":"Metropolitana"},{"comuna":"Cerro Navia","promedioIDI":143.2,"longitud":-70.7445869321,"latitud":-33.4224795137,"region":"Metropolitana"},{"comuna":"Chaitén","promedioIDI":41.04,"longitud":-72.5758267231,"latitud":-43.0931422114,"region":"Los Lagos"},{"comuna":"Chanco","promedioIDI":51.08,"longitud":-72.4850225684,"latitud":-35.6989405518,"region":"Maule"},{"comuna":"Chañaral","promedioIDI":96.83,"longitud":-70.3379746068,"latitud":-26.3725371013,"region":"Atacama"},{"comuna":"Chiguayante","promedioIDI":69.05,"longitud":-73.0051869676,"latitud":-36.9007781691,"region":"Biobío"},{"comuna":"Chile Chico","promedioIDI":56.71,"longitud":-72.586427804,"latitud":-46.7683852043,"region":"Aysén"},{"comuna":"Chillán","promedioIDI":76.65,"longitud":-72.1287244312,"latitud":-36.6174916649,"region":"Ñuble"},{"comuna":"Chillán Viejo","promedioIDI":68.24,"longitud":-72.1988051799,"latitud":-36.6803542471,"region":"Ñuble"},{"comuna":"Chimbarongo","promedioIDI":59.93,"longitud":-70.9808799529,"latitud":-34.7516789138,"region":"O'Higgins"},{"comuna":"Cholchol","promedioIDI":69.5,"longitud":-72.9023872851,"latitud":-38.5834330094,"region":"La Araucanía"},{"comuna":"Chonchi","promedioIDI":57.95,"longitud":-73.9306025761,"latitud":-42.6817830669,"region":"Los Lagos"},{"comuna":"Chépica","promedioIDI":52.98,"longitud":-71.3597393619,"latitud":-34.7919579496,"region":"O'Higgins"},{"comuna":"Cisnes","promedioIDI":61.58,"longitud":-73.1371398973,"latitud":-44.4562344109,"region":"Aysén"},{"comuna":"Cobquecura","promedioIDI":43.7,"longitud":-72.7205933691,"latitud":-36.1808797901,"region":"Ñuble"},{"comuna":"Cochamó","promedioIDI":53.93,"longitud":-72.0917081076,"latitud":-41.7590776763,"region":"Los Lagos"},{"comuna":"Cochrane","promedioIDI":63.15,"longitud":-72.7436231209,"latitud":-47.3573604502,"region":"Aysén"},{"comuna":"Codegua","promedioIDI":64.88,"longitud":-70.547188352,"latitud":-34.0570836011,"region":"O'Higgins"},{"comuna":"Coelemu","promedioIDI":50.21,"longitud":-72.7504237915,"latitud":-36.5049812005,"region":"Ñuble"},{"comuna":"Coihaique","promedioIDI":80.67,"longitud":-71.99173699,"latitud":-45.5547953839,"region":"Aysén"},{"comuna":"Coihueco","promedioIDI":49.78,"longitud":-71.5817371361,"latitud":-36.7019154417,"region":"Ñuble"},{"comuna":"Coinco","promedioIDI":55.98,"longitud":-70.97110458,"latitud":-34.2823216055,"region":"O'Higgins"},{"comuna":"Colbún","promedioIDI":55.63,"longitud":-70.9801742421,"latitud":-36.0761045764,"region":"Maule"},{"comuna":"Colchane","promedioIDI":254.23,"longitud":-68.8442188762,"latitud":-19.3530234736,"region":"Tarapacá"},{"comuna":"Colina","promedioIDI":101.05,"longitud":-70.6160981639,"latitud":-33.1348994888,"region":"Metropolitana"},{"comuna":"Collipulli","promedioIDI":90.57,"longitud":-72.1247823882,"latitud":-38.026440001,"region":"La Araucanía"},{"comuna":"Coltauco","promedioIDI":52.21,"longitud":-71.0775608206,"latitud":-34.2596516789,"region":"O'Higgins"},{"comuna":"Combarbalá","promedioIDI":39.9,"longitud":-70.9657356492,"latitud":-31.1464545741,"region":"Coquimbo"},{"comuna":"Concepción","promedioIDI":123.93,"longitud":-72.9508292392,"latitud":-36.8343032785,"region":"Biobío"},{"comuna":"Conchalí","promedioIDI":159.39,"longitud":-70.6769054419,"latitud":-33.3837226006,"region":"Metropolitana"},{"comuna":"Concón","promedioIDI":76.68,"longitud":-71.4678670083,"latitud":-32.9532977141,"region":"Valparaíso"},{"comuna":"Constitución","promedioIDI":64.37,"longitud":-72.2757990108,"latitud":-35.3630360324,"region":"Maule"},{"comuna":"Contulmo","promedioIDI":68.9,"longitud":-73.2119647769,"latitud":-38.0524592177,"region":"Biobío"},{"comuna":"Copiapó","promedioIDI":110.33,"longitud":-69.82547165,"latitud":-27.3205190244,"region":"Atacama"},{"comuna":"Coquimbo","promedioIDI":100.03,"longitud":-71.3589871987,"latitud":-30.2274175634,"region":"Coquimbo"},{"comuna":"Coronel","promedioIDI":94.72,"longitud":-73.1255841444,"latitud":-37.0072133621,"region":"Biobío"},{"comuna":"Corral","promedioIDI":60.91,"longitud":-73.3716133312,"latitud":-39.9851786998,"region":"Los Ríos"},{"comuna":"Cunco","promedioIDI":67.27,"longitud":-71.9922993971,"latitud":-38.9772539633,"region":"La Araucanía"},{"comuna":"Curacautín","promedioIDI":63.53,"longitud":-71.7720702181,"latitud":-38.4271556717,"region":"La Araucanía"},{"comuna":"Curacaví","promedioIDI":84.88,"longitud":-71.0801315878,"latitud":-33.3664865657,"region":"Metropolitana"},{"comuna":"Curaco de Vélez","promedioIDI":31.28,"longitud":-73.5786872572,"latitud":-42.4265401752,"region":"Los Lagos"},{"comuna":"Curanilahue","promedioIDI":70.83,"longitud":-73.2356455822,"latitud":-37.4828989129,"region":"Biobío"},{"comuna":"Curarrehue","promedioIDI":82.05,"longitud":-71.5391563454,"latitud":-39.3364715255,"region":"La Araucanía"},{"comuna":"Curepto","promedioIDI":40.04,"longitud":-71.9529801365,"latitud":-35.1297379581,"region":"Maule"},{"comuna":"Curicó","promedioIDI":90.37,"longitud":-70.8973707757,"latitud":-35.198494361,"region":"Maule"},{"comuna":"Dalcahue","promedioIDI":62.01,"longitud":-73.8332952253,"latitud":-42.3088608227,"region":"Los Lagos"},{"comuna":"Diego de Almagro","promedioIDI":66.45,"longitud":-69.1860389258,"latitud":-26.236152679,"region":"Atacama"},{"comuna":"Doñihue","promedioIDI":61.96,"longitud":-70.9236348255,"latitud":-34.1967775011,"region":"O'Higgins"},{"comuna":"El Bosque","promedioIDI":142.16,"longitud":-70.6763067367,"latitud":-33.5628660108,"region":"Metropolitana"},{"comuna":"El Carmen","promedioIDI":58.43,"longitud":-71.8471105616,"latitud":-36.9251112652,"region":"Ñuble"},{"comuna":"El Monte","promedioIDI":76.2,"longitud":-71.0335418234,"latitud":-33.6678791261,"region":"Metropolitana"},{"comuna":"El Quisco","promedioIDI":120.21,"longitud":-71.651188756,"latitud":-33.4150669686,"region":"Valparaíso"},{"comuna":"El Tabo","promedioIDI":130.06,"longitud":-71.5806343546,"latitud":-33.482883833,"region":"Valparaíso"},{"comuna":"Empedrado","promedioIDI":39.13,"longitud":-72.284386519,"latitud":-35.6135199969,"region":"Maule"},{"comuna":"Ercilla","promedioIDI":136.5,"longitud":-72.3531374892,"latitud":-38.0828410497,"region":"La Araucanía"},{"comuna":"Estación Central","promedioIDI":182.91,"longitud":-70.7009892068,"latitud":-33.4644562811,"region":"Metropolitana"},{"comuna":"Florida","promedioIDI":62.22,"longitud":-72.7177998529,"latitud":-36.8223061835,"region":"Biobío"},{"comuna":"Freire","promedioIDI":67.18,"longitud":-72.5763040704,"latitud":-38.949527018,"region":"La Araucanía"},{"comuna":"Freirina","promedioIDI":55.87,"longitud":-71.1788201806,"latitud":-28.8119566657,"region":"Atacama"},{"comuna":"Fresia","promedioIDI":59.05,"longitud":-73.6067200675,"latitud":-41.1545474886,"region":"Los Lagos"},{"comuna":"Frutillar","promedioIDI":66.07,"longitud":-73.0959170387,"latitud":-41.087394356,"region":"Los Lagos"},{"comuna":"Futaleufú","promedioIDI":54.69,"longitud":-72.0071718855,"latitud":-43.1805554497,"region":"Los Lagos"},{"comuna":"Futrono","promedioIDI":63.03,"longitud":-72.1160048195,"latitud":-40.1185841775,"region":"Los Ríos"},{"comuna":"Galvarino","promedioIDI":65.38,"longitud":-72.7917283082,"latitud":-38.4482173337,"region":"La Araucanía"},{"comuna":"General Lagos","promedioIDI":62.41,"longitud":-69.5707228083,"latitud":-17.8292135024,"region":"Arica y Parinacota"},{"comuna":"Gorbea","promedioIDI":75.65,"longitud":-72.669618655,"latitud":-39.1719511933,"region":"La Araucanía"},{"comuna":"Graneros","promedioIDI":88.74,"longitud":-70.7470714577,"latitud":-34.0656328638,"region":"O'Higgins"},{"comuna":"Guaitecas","promedioIDI":94.69,"longitud":-73.837636296,"latitud":-43.9310898949,"region":"Aysén"},{"comuna":"Hijuelas","promedioIDI":55.74,"longitud":-71.0811107747,"latitud":-32.8693023067,"region":"Valparaíso"},{"comuna":"Hualaihué","promedioIDI":65.64,"longitud":-72.3775160289,"latitud":-42.1767030485,"region":"Los Lagos"},{"comuna":"Hualañé","promedioIDI":59.69,"longitud":-71.7087939486,"latitud":-34.952615122,"region":"Maule"},{"comuna":"Hualpén","promedioIDI":89.33,"longitud":-73.141186622,"latitud":-36.7887941186,"region":"Biobío"},{"comuna":"Hualqui","promedioIDI":68.63,"longitud":-72.8710349587,"latitud":-37.0447673918,"region":"Biobío"},{"comuna":"Huara","promedioIDI":165.4,"longitud":-69.6628965053,"latitud":-19.6025868446,"region":"Tarapacá"},{"comuna":"Huasco","promedioIDI":68.65,"longitud":-71.0280980766,"latitud":-28.2462586789,"region":"Atacama"},{"comuna":"Huechuraba","promedioIDI":124.3,"longitud":-70.6382097062,"latitud":-33.3603864655,"region":"Metropolitana"},{"comuna":"Illapel","promedioIDI":58.19,"longitud":-70.9705682605,"latitud":-31.5495159293,"region":"Coquimbo"},{"comuna":"Independencia","promedioIDI":137.46,"longitud":-70.6652854661,"latitud":-33.4148683626,"region":"Metropolitana"},{"comuna":"Iquique","promedioIDI":130.32,"longitud":-70.041538352,"latitud":-20.9406151208,"region":"Tarapacá"},{"comuna":"Isla de Maipo","promedioIDI":69.62,"longitud":-70.9459116223,"latitud":-33.7487199371,"region":"Metropolitana"},{"comuna":"Isla de Pascua","promedioIDI":122.14,"longitud":-109.477524207,"latitud":-27.0892325526,"region":"Valparaíso"},{"comuna":"Juan Fernández","promedioIDI":109.44,"longitud":-79.8701772623,"latitud":-33.7155812293,"region":"Valparaíso"},{"comuna":"La Cisterna","promedioIDI":211.98,"longitud":-70.6639942163,"latitud":-33.5302579467,"region":"Metropolitana"},{"comuna":"La Cruz","promedioIDI":41.98,"longitud":-71.2404787004,"latitud":-32.8253212446,"region":"Valparaíso"},{"comuna":"La Estrella","promedioIDI":60.23,"longitud":-71.6025513707,"latitud":-34.2231126322,"region":"O'Higgins"},{"comuna":"La Florida","promedioIDI":124.61,"longitud":-70.5399741188,"latitud":-33.5284141101,"region":"Metropolitana"},{"comuna":"La Granja","promedioIDI":173.11,"longitud":-70.6226262658,"latitud":-33.5355839141,"region":"Metropolitana"},{"comuna":"La Higuera","promedioIDI":79.9,"longitud":-70.9025648798,"latitud":-29.3747771258,"region":"Coquimbo"},{"comuna":"La Ligua","promedioIDI":80.2,"longitud":-71.2717016023,"latitud":-32.3535901599,"region":"Valparaíso"},{"comuna":"La Pintana","promedioIDI":158.88,"longitud":-70.6372519122,"latitud":-33.5875956254,"region":"Metropolitana"},{"comuna":"La Reina","promedioIDI":78.77,"longitud":-70.5368973286,"latitud":-33.4472983533,"region":"Metropolitana"},{"comuna":"La Serena","promedioIDI":94.79,"longitud":-71.0608208619,"latitud":-29.7891138006,"region":"Coquimbo"},{"comuna":"La Unión","promedioIDI":69.47,"longitud":-73.2223210849,"latitud":-40.2017945002,"region":"Los Ríos"},{"comuna":"Lago Ranco","promedioIDI":70.0,"longitud":-72.1661660163,"latitud":-40.3726777372,"region":"Los Ríos"},{"comuna":"Lago Verde","promedioIDI":61.2,"longitud":-71.8342823809,"latitud":-44.4923446499,"region":"Aysén"},{"comuna":"Laguna Blanca","promedioIDI":33.75,"longitud":-71.2403490256,"latitud":-52.3290846055,"region":"Magallanes"},{"comuna":"Laja","promedioIDI":63.28,"longitud":-72.5825330104,"latitud":-37.3126097035,"region":"Biobío"},{"comuna":"Lampa","promedioIDI":115.5,"longitud":-70.8751595286,"latitud":-33.2781069011,"region":"Metropolitana"},{"comuna":"Lanco","promedioIDI":65.17,"longitud":-72.6215188458,"latitud":-39.5121811782,"region":"Los Ríos"},{"comuna":"Las Cabras","promedioIDI":74.76,"longitud":-71.3327813423,"latitud":-34.1646843753,"region":"O'Higgins"},{"comuna":"Las Condes","promedioIDI":44.36,"longitud":-70.5013173991,"latitud":-33.4212491652,"region":"Metropolitana"},{"comuna":"Lautaro","promedioIDI":81.13,"longitud":-72.289099197,"latitud":-38.5433593257,"region":"La Araucanía"},{"comuna":"Lebu","promedioIDI":73.84,"longitud":-73.5898697354,"latitud":-37.6767770827,"region":"Biobío"},{"comuna":"Licantén","promedioIDI":77.83,"longitud":-72.060329116,"latitud":-34.9742866969,"region":"Maule"},{"comuna":"Limache","promedioIDI":70.98,"longitud":-71.2789117691,"latitud":-33.0307721107,"region":"Valparaíso"},{"comuna":"Linares","promedioIDI":77.22,"longitud":-71.3325671389,"latitud":-35.9582747955,"region":"Maule"},{"comuna":"Litueche","promedioIDI":72.1,"longitud":-71.7330914364,"latitud":-34.1070309895,"region":"O'Higgins"},{"comuna":"Llaillay","promedioIDI":78.98,"longitud":-70.9017326371,"latitud":-32.8880576134,"region":"Valparaíso"},{"comuna":"Llanquihue","promedioIDI":73.64,"longitud":-73.1396596418,"latitud":-41.237836696,"region":"Los Lagos"},{"comuna":"Lo Barnechea","promedioIDI":44.88,"longitud":-70.3686132049,"latitud":-33.2992823113,"region":"Metropolitana"},{"comuna":"Lo Espejo","promedioIDI":168.91,"longitud":-70.6900083545,"latitud":-33.5206260898,"region":"Metropolitana"},{"comuna":"Lo Prado","promedioIDI":155.27,"longitud":-70.7232074374,"latitud":-33.4471037431,"region":"Metropolitana"},{"comuna":"Lolol","promedioIDI":45.3,"longitud":-71.6488324554,"latitud":-34.7682481718,"region":"O'Higgins"},{"comuna":"Loncoche","promedioIDI":72.74,"longitud":-72.5829141628,"latitud":-39.3562858699,"region":"La Araucanía"},{"comuna":"Longaví","promedioIDI":63.58,"longitud":-71.4419609374,"latitud":-36.1104406227,"region":"Maule"},{"comuna":"Lonquimay","promedioIDI":80.26,"longitud":-71.2397410148,"latitud":-38.4733237141,"region":"La Araucanía"},{"comuna":"Los Alamos","promedioIDI":69.38,"longitud":-73.3569413528,"latitud":-37.6735822108,"region":"Biobío"},{"comuna":"Los Andes","promedioIDI":89.91,"longitud":-70.2435624785,"latitud":-32.9509221798,"region":"Valparaíso"},{"comuna":"Los Angeles","promedioIDI":83.57,"longitud":-72.3274299995,"latitud":-37.40749778,"region":"Biobío"},{"comuna":"Los Lagos","promedioIDI":67.01,"longitud":-72.5546755679,"latitud":-39.878511278,"region":"Los Ríos"},{"comuna":"Los Muermos","promedioIDI":52.81,"longitud":-73.5818323869,"latitud":-41.3970848585,"region":"Los Lagos"},{"comuna":"Los Sauces","promedioIDI":57.69,"longitud":-72.7969068396,"latitud":-37.9828557075,"region":"La Araucanía"},{"comuna":"Los Vilos","promedioIDI":93.32,"longitud":-71.3042545677,"latitud":-31.977943913,"region":"Coquimbo"},{"comuna":"Lota","promedioIDI":92.9,"longitud":-73.1049584928,"latitud":-37.1195814608,"region":"Biobío"},{"comuna":"Lumaco","promedioIDI":56.07,"longitud":-73.0457005279,"latitud":-38.2871424252,"region":"La Araucanía"},{"comuna":"Machalí","promedioIDI":53.3,"longitud":-70.319487195,"latitud":-34.3204980754,"region":"O'Higgins"},{"comuna":"Macul","promedioIDI":123.43,"longitud":-70.6003158286,"latitud":-33.4896213742,"region":"Metropolitana"},{"comuna":"Maipú","promedioIDI":110.86,"longitud":-70.8097575548,"latitud":-33.5069808741,"region":"Metropolitana"},{"comuna":"Malloa","promedioIDI":57.88,"longitud":-70.8729170446,"latitud":-34.4764967817,"region":"O'Higgins"},{"comuna":"Marchihue","promedioIDI":55.5,"longitud":-71.6717648667,"latitud":-34.3725789625,"region":"O'Higgins"},{"comuna":"Mariquina","promedioIDI":70.03,"longitud":-73.0192282365,"latitud":-39.5126916723,"region":"Los Ríos"},{"comuna":"María Elena","promedioIDI":117.25,"longitud":-69.4670674746,"latitud":-22.0929370368,"region":"Antofagasta"},{"comuna":"María Pinto","promedioIDI":58.46,"longitud":-71.2104003581,"latitud":-33.4980838305,"region":"Metropolitana"},{"comuna":"Maule","promedioIDI":51.89,"longitud":-71.7120541694,"latitud":-35.5082259024,"region":"Maule"},{"comuna":"Maullín","promedioIDI":58.82,"longitud":-73.5026860801,"latitud":-41.634515625,"region":"Los Lagos"},{"comuna":"Mejillones","promedioIDI":100.17,"longitud":-70.2030457945,"latitud":-22.9465783529,"region":"Antofagasta"},{"comuna":"Melipeuco","promedioIDI":70.65,"longitud":-71.6108924678,"latitud":-38.8246406469,"region":"La Araucanía"},{"comuna":"Melipilla","promedioIDI":112.46,"longitud":-71.1936904819,"latitud":-33.7437525386,"region":"Metropolitana"},{"comuna":"Molina","promedioIDI":86.05,"longitud":-70.9109223843,"latitud":-35.352765887,"region":"Maule"},{"comuna":"Monte Patria","promedioIDI":40.92,"longitud":-70.650608689,"latitud":-30.8341952042,"region":"Coquimbo"},{"comuna":"Mostazal","promedioIDI":93.07,"longitud":-70.5688119247,"latitud":-33.9557360745,"region":"O'Higgins"},{"comuna":"Mulchén","promedioIDI":69.41,"longitud":-72.0977882402,"latitud":-37.8382979084,"region":"Biobío"},{"comuna":"Máfil","promedioIDI":72.14,"longitud":-72.8639087599,"latitud":-39.6920999834,"region":"Los Ríos"},{"comuna":"Nacimiento","promedioIDI":54.07,"longitud":-72.823547161,"latitud":-37.4854861399,"region":"Biobío"},{"comuna":"Nancagua","promedioIDI":79.87,"longitud":-71.1919713174,"latitud":-34.6674617354,"region":"O'Higgins"},{"comuna":"Natales","promedioIDI":70.44,"longitud":-73.9834575532,"latitud":-50.647579808,"region":"Magallanes"},{"comuna":"Navidad","promedioIDI":59.01,"longitud":-71.8207690244,"latitud":-34.0127664329,"region":"O'Higgins"},{"comuna":"Negrete","promedioIDI":62.64,"longitud":-72.5763606925,"latitud":-37.6080826551,"region":"Biobío"},{"comuna":"Ninhue","promedioIDI":44.33,"longitud":-72.4097067642,"latitud":-36.3567574884,"region":"Ñuble"},{"comuna":"Nogales","promedioIDI":67.24,"longitud":-71.1761018798,"latitud":-32.6914347168,"region":"Valparaíso"},{"comuna":"Nueva Imperial","promedioIDI":79.13,"longitud":-72.9720610851,"latitud":-38.7515999667,"region":"La Araucanía"},{"comuna":"O'Higgins","promedioIDI":84.67,"longitud":-72.9090271193,"latitud":-48.4832949503,"region":"Aysén"},{"comuna":"Olivar","promedioIDI":64.0,"longitud":-70.8210998259,"latitud":-34.2115968517,"region":"O'Higgins"},{"comuna":"Ollagüe","promedioIDI":146.34,"longitud":-68.3132579862,"latitud":-21.4582406471,"region":"Antofagasta"},{"comuna":"Olmué","promedioIDI":60.69,"longitud":-71.1104338102,"latitud":-33.0356586297,"region":"Valparaíso"},{"comuna":"Osorno","promedioIDI":89.97,"longitud":-73.0867453662,"latitud":-40.6118925181,"region":"Los Lagos"},{"comuna":"Ovalle","promedioIDI":71.37,"longitud":-71.4053054306,"latitud":-30.6730105462,"region":"Coquimbo"},{"comuna":"Padre Hurtado","promedioIDI":89.05,"longitud":-70.8710073491,"latitud":-33.5575346736,"region":"Metropolitana"},{"comuna":"Padre las Casas","promedioIDI":65.98,"longitud":-72.5788411915,"latitud":-38.7917117043,"region":"La Araucanía"},{"comuna":"Paiguano","promedioIDI":83.71,"longitud":-70.3697470219,"latitud":-30.2376308962,"region":"Coquimbo"},{"comuna":"Paillaco","promedioIDI":68.24,"longitud":-72.8434415696,"latitud":-40.0743528969,"region":"Los Ríos"},{"comuna":"Paine","promedioIDI":83.96,"longitud":-70.7583137013,"latitud":-33.8637126554,"region":"Metropolitana"},{"comuna":"Palena","promedioIDI":48.74,"longitud":-71.9835777041,"latitud":-43.6838894873,"region":"Los Lagos"},{"comuna":"Palmilla","promedioIDI":46.76,"longitud":-71.3529130902,"latitud":-34.5279648403,"region":"O'Higgins"},{"comuna":"Panguipulli","promedioIDI":75.52,"longitud":-72.0297441379,"latitud":-39.7146031523,"region":"Los Ríos"},{"comuna":"Panquehue","promedioIDI":61.9,"longitud":-70.8283122248,"latitud":-32.7936970201,"region":"Valparaíso"},{"comuna":"Papudo","promedioIDI":66.96,"longitud":-71.3803278083,"latitud":-32.4749351233,"region":"Valparaíso"},{"comuna":"Paredones","promedioIDI":49.61,"longitud":-71.9115377098,"latitud":-34.6733611039,"region":"O'Higgins"},{"comuna":"Parral","promedioIDI":70.78,"longitud":-71.6466288589,"latitud":-36.2621427969,"region":"Maule"},{"comuna":"Pedro Aguirre Cerda","promedioIDI":142.89,"longitud":-70.6756529433,"latitud":-33.4917427389,"region":"Metropolitana"},{"comuna":"Pelarco","promedioIDI":52.5,"longitud":-71.3500292078,"latitud":-35.3830758129,"region":"Maule"},{"comuna":"Pelluhue","promedioIDI":87.28,"longitud":-72.6074092657,"latitud":-35.9115389247,"region":"Maule"},{"comuna":"Pemuco","promedioIDI":71.74,"longitud":-72.0678475373,"latitud":-36.9830646776,"region":"Ñuble"},{"comuna":"Pencahue","promedioIDI":46.93,"longitud":-71.8161738166,"latitud":-35.3275247151,"region":"Maule"},{"comuna":"Penco","promedioIDI":79.54,"longitud":-72.9437440844,"latitud":-36.7478790007,"region":"Biobío"},{"comuna":"Peralillo","promedioIDI":57.69,"longitud":-71.4966804722,"latitud":-34.4660185232,"region":"O'Higgins"},{"comuna":"Perquenco","promedioIDI":83.47,"longitud":-72.4366359412,"latitud":-38.428277539,"region":"La Araucanía"},{"comuna":"Petorca","promedioIDI":53.14,"longitud":-70.869906028,"latitud":-32.1905086567,"region":"Valparaíso"},{"comuna":"Peumo","promedioIDI":66.47,"longitud":-71.2218813362,"latitud":-34.3290257069,"region":"O'Higgins"},{"comuna":"Peñaflor","promedioIDI":82.16,"longitud":-70.8937471949,"latitud":-33.6110597266,"region":"Metropolitana"},{"comuna":"Peñalolén","promedioIDI":90.74,"longitud":-70.525497685,"latitud":-33.4854653623,"region":"Metropolitana"},{"comuna":"Pica","promedioIDI":51.64,"longitud":-68.9122031293,"latitud":-20.4789531968,"region":"Tarapacá"},{"comuna":"Pichidegua","promedioIDI":56.26,"longitud":-71.339092237,"latitud":-34.3711755627,"region":"O'Higgins"},{"comuna":"Pichilemu","promedioIDI":94.5,"longitud":-71.9106902935,"latitud":-34.3838926004,"region":"O'Higgins"},{"comuna":"Pinto","promedioIDI":49.28,"longitud":-71.4999442772,"latitud":-36.9214503508,"region":"Ñuble"},{"comuna":"Pirque","promedioIDI":63.84,"longitud":-70.5068294787,"latitud":-33.7184830956,"region":"Metropolitana"},{"comuna":"Pitrufquén","promedioIDI":76.82,"longitud":-72.6638092543,"latitud":-39.08406273,"region":"La Araucanía"},{"comuna":"Placilla","promedioIDI":63.91,"longitud":-71.0863094472,"latitud":-34.6190012575,"region":"O'Higgins"},{"comuna":"Portezuelo","promedioIDI":33.05,"longitud":-72.4666382514,"latitud":-36.5462820853,"region":"Ñuble"},{"comuna":"Porvenir","promedioIDI":75.7,"longitud":-69.3800932016,"latitud":-53.3131314213,"region":"Magallanes"},{"comuna":"Pozo Almonte","promedioIDI":131.28,"longitud":-69.5042362991,"latitud":-20.7676484493,"region":"Tarapacá"},{"comuna":"Primavera","promedioIDI":35.35,"longitud":-69.3296827829,"latitud":-52.8180457345,"region":"Magallanes"},{"comuna":"Providencia","promedioIDI":146.36,"longitud":-70.6124427502,"latitud":-33.4318510545,"region":"Metropolitana"},{"comuna":"Puchuncaví","promedioIDI":109.01,"longitud":-71.3879230101,"latitud":-32.7453043053,"region":"Valparaíso"},{"comuna":"Pucón","promedioIDI":90.08,"longitud":-71.7912464818,"latitud":-39.2701583983,"region":"La Araucanía"},{"comuna":"Pudahuel","promedioIDI":154.16,"longitud":-70.8548358134,"latitud":-33.4240839322,"region":"Metropolitana"},{"comuna":"Puente Alto","promedioIDI":123.71,"longitud":-70.5579820209,"latitud":-33.5911737357,"region":"Metropolitana"},{"comuna":"Puerto Montt","promedioIDI":107.45,"longitud":-72.7955813241,"latitud":-41.4889346963,"region":"Los Lagos"},{"comuna":"Puerto Octay","promedioIDI":56.87,"longitud":-72.5996861674,"latitud":-40.9334514982,"region":"Los Lagos"},{"comuna":"Puerto Varas","promedioIDI":65.82,"longitud":-72.3881107087,"latitud":-41.1907355599,"region":"Los Lagos"},{"comuna":"Pumanque","promedioIDI":63.9,"longitud":-71.6917721695,"latitud":-34.5958698384,"region":"O'Higgins"},{"comuna":"Punitaqui","promedioIDI":42.92,"longitud":-71.3326274023,"latitud":-30.9461005607,"region":"Coquimbo"},{"comuna":"Punta Arenas","promedioIDI":56.19,"longitud":-72.0254461498,"latitud":-53.6467902489,"region":"Magallanes"},{"comuna":"Puqueldón","promedioIDI":42.64,"longitud":-73.6370931112,"latitud":-42.626753449,"region":"Los Lagos"},{"comuna":"Purranque","promedioIDI":64.97,"longitud":-73.4579156099,"latitud":-40.9357379405,"region":"Los Lagos"},{"comuna":"Purén","promedioIDI":63.35,"longitud":-73.0504211711,"latitud":-38.0121451066,"region":"La Araucanía"},{"comuna":"Putaendo","promedioIDI":65.89,"longitud":-70.5212302349,"latitud":-32.4811133119,"region":"Valparaíso"},{"comuna":"Putre","promedioIDI":72.24,"longitud":-69.3101930709,"latitud":-18.4275114297,"region":"Arica y Parinacota"},{"comuna":"Puyehue","promedioIDI":68.22,"longitud":-72.384008281,"latitud":-40.7258239494,"region":"Los Lagos"},{"comuna":"Queilén","promedioIDI":50.11,"longitud":-73.5643440522,"latitud":-42.8557290758,"region":"Los Lagos"},{"comuna":"Quellón","promedioIDI":81.3,"longitud":-73.9939296615,"latitud":-43.1510471013,"region":"Los Lagos"},{"comuna":"Quemchi","promedioIDI":39.19,"longitud":-73.4114986361,"latitud":-42.1789504236,"region":"Los Lagos"},{"comuna":"Quilaco","promedioIDI":51.54,"longitud":-71.7056814327,"latitud":-37.9604016736,"region":"Biobío"},{"comuna":"Quilicura","promedioIDI":128.4,"longitud":-70.7354190659,"latitud":-33.3557121273,"region":"Metropolitana"},{"comuna":"Quilleco","promedioIDI":51.19,"longitud":-71.8615463754,"latitud":-37.4367035948,"region":"Biobío"},{"comuna":"Quillota","promedioIDI":74.24,"longitud":-71.2724210415,"latitud":-32.9047476491,"region":"Valparaíso"},{"comuna":"Quillón","promedioIDI":70.98,"longitud":-72.5018054716,"latitud":-36.8184580623,"region":"Ñuble"},{"comuna":"Quilpué","promedioIDI":85.09,"longitud":-71.2540917137,"latitud":-33.1473777099,"region":"Valparaíso"},{"comuna":"Quinchao","promedioIDI":50.79,"longitud":-73.3589227833,"latitud":-42.521585106,"region":"Los Lagos"},{"comuna":"Quinta Normal","promedioIDI":211.17,"longitud":-70.7013745412,"latitud":-33.4278344665,"region":"Metropolitana"},{"comuna":"Quinta de Tilcoco","promedioIDI":59.63,"longitud":-70.9980672834,"latitud":-34.3592220744,"region":"O'Higgins"},{"comuna":"Quintero","promedioIDI":123.68,"longitud":-71.4732304592,"latitud":-32.8431808329,"region":"Valparaíso"},{"comuna":"Quirihue","promedioIDI":61.64,"longitud":-72.5436475817,"latitud":-36.2355993306,"region":"Ñuble"},{"comuna":"Rancagua","promedioIDI":105.46,"longitud":-70.816747872,"latitud":-34.1257615173,"region":"O'Higgins"},{"comuna":"Rauco","promedioIDI":51.76,"longitud":-71.4257655703,"latitud":-34.9377136252,"region":"Maule"},{"comuna":"Recoleta","promedioIDI":216.99,"longitud":-70.6395869549,"latitud":-33.4057938065,"region":"Metropolitana"},{"comuna":"Renaico","promedioIDI":80.76,"longitud":-72.5755910381,"latitud":-37.7175856821,"region":"La Araucanía"},{"comuna":"Renca","promedioIDI":149.02,"longitud":-70.727935172,"latitud":-33.4019186431,"region":"Metropolitana"},{"comuna":"Rengo","promedioIDI":77.08,"longitud":-70.7189568704,"latitud":-34.4546323352,"region":"O'Higgins"},{"comuna":"Requínoa","promedioIDI":62.5,"longitud":-70.6591961618,"latitud":-34.3348783694,"region":"O'Higgins"},{"comuna":"Retiro","promedioIDI":52.09,"longitud":-71.8299458071,"latitud":-36.0022006457,"region":"Maule"},{"comuna":"Rinconada","promedioIDI":60.9,"longitud":-70.7061975531,"latitud":-32.8763396721,"region":"Valparaíso"},{"comuna":"Romeral","promedioIDI":75.66,"longitud":-70.712024862,"latitud":-35.0681631557,"region":"Maule"},{"comuna":"Ránquil","promedioIDI":46.8,"longitud":-72.5879597646,"latitud":-36.6404630897,"region":"Ñuble"},{"comuna":"Río Bueno","promedioIDI":65.77,"longitud":-72.535439593,"latitud":-40.496190764,"region":"Los Ríos"},{"comuna":"Río Claro","promedioIDI":48.77,"longitud":-71.2688621061,"latitud":-35.2606233799,"region":"Maule"},{"comuna":"Río Hurtado","promedioIDI":43.61,"longitud":-70.653739198,"latitud":-30.4306794897,"region":"Coquimbo"},{"comuna":"Río Ibáñez","promedioIDI":55.11,"longitud":-72.4875462731,"latitud":-46.2997048861,"region":"Aysén"},{"comuna":"Río Negro","promedioIDI":65.32,"longitud":-73.4176981519,"latitud":-40.7711401598,"region":"Los Lagos"},{"comuna":"Río Verde","promedioIDI":10.99,"longitud":-72.4573600267,"latitud":-52.8440072895,"region":"Magallanes"},{"comuna":"Saavedra","promedioIDI":63.24,"longitud":-73.2955377625,"latitud":-38.8325547451,"region":"La Araucanía"},{"comuna":"Sagrada Familia","promedioIDI":56.22,"longitud":-71.495698972,"latitud":-35.1036000083,"region":"Maule"},{"comuna":"Salamanca","promedioIDI":59.48,"longitud":-70.6619085753,"latitud":-31.8935829379,"region":"Coquimbo"},{"comuna":"San Antonio","promedioIDI":106.7,"longitud":-71.4869305281,"latitud":-33.6671475155,"region":"Valparaíso"},{"comuna":"San Bernardo","promedioIDI":171.96,"longitud":-70.724181018,"latitud":-33.6292694295,"region":"Metropolitana"},{"comuna":"San Carlos","promedioIDI":77.56,"longitud":-72.019057169,"latitud":-36.385746064,"region":"Ñuble"},{"comuna":"San Clemente","promedioIDI":59.12,"longitud":-70.8497817736,"latitud":-35.7115669361,"region":"Maule"},{"comuna":"San Esteban","promedioIDI":51.33,"longitud":-70.3477585261,"latitud":-32.6863307937,"region":"Valparaíso"},{"comuna":"San Fabián","promedioIDI":103.1,"longitud":-71.2877565913,"latitud":-36.5798231906,"region":"Ñuble"},{"comuna":"San Felipe","promedioIDI":95.05,"longitud":-70.7529583568,"latitud":-32.736396253,"region":"Valparaíso"},{"comuna":"San Fernando","promedioIDI":102.48,"longitud":-70.6032868181,"latitud":-34.7435512842,"region":"O'Higgins"},{"comuna":"San Gregorio","promedioIDI":76.12,"longitud":-70.1959724678,"latitud":-52.317534666,"region":"Magallanes"},{"comuna":"San Ignacio","promedioIDI":55.11,"longitud":-72.0294015314,"latitud":-36.8224478954,"region":"Ñuble"},{"comuna":"San Javier","promedioIDI":77.04,"longitud":-71.9270734738,"latitud":-35.6288205387,"region":"Maule"},{"comuna":"San Joaquín","promedioIDI":143.04,"longitud":-70.6287005921,"latitud":-33.4962058728,"region":"Metropolitana"},{"comuna":"San José de Maipo","promedioIDI":78.88,"longitud":-70.0965071709,"latitud":-33.7036172594,"region":"Metropolitana"},{"comuna":"San Juan de La Costa","promedioIDI":85.45,"longitud":-73.5591952549,"latitud":-40.5089957648,"region":"Los Lagos"},{"comuna":"San Miguel","promedioIDI":172.72,"longitud":-70.6517764643,"latitud":-33.4991877079,"region":"Metropolitana"},{"comuna":"San Nicolás","promedioIDI":55.73,"longitud":-72.2283817817,"latitud":-36.4796077479,"region":"Ñuble"},{"comuna":"San Pablo","promedioIDI":58.5,"longitud":-73.1616793387,"latitud":-40.4273250967,"region":"Los Lagos"},{"comuna":"San Pedro","promedioIDI":85.45,"longitud":-71.4527103289,"latitud":-33.9317902219,"region":"Metropolitana"},{"comuna":"San Pedro de Atacama","promedioIDI":68.8,"longitud":-67.9093983783,"latitud":-23.4017631814,"region":"Antofagasta"},{"comuna":"San Pedro de la Paz","promedioIDI":82.9,"longitud":-73.098476665,"latitud":-36.8809102037,"region":"Biobío"},{"comuna":"San Rafael","promedioIDI":58.8,"longitud":-71.5004743803,"latitud":-35.3015046094,"region":"Maule"},{"comuna":"San Ramón","promedioIDI":157.51,"longitud":-70.6423153126,"latitud":-33.5405373668,"region":"Metropolitana"},{"comuna":"San Rosendo","promedioIDI":74.13,"longitud":-72.7212581436,"latitud":-37.2132269621,"region":"Biobío"},{"comuna":"San Vicente","promedioIDI":65.38,"longitud":-71.123127305,"latitud":-34.4774521387,"region":"O'Higgins"},{"comuna":"Santa Bárbara","promedioIDI":64.49,"longitud":-71.7482059274,"latitud":-37.6232103904,"region":"Biobío"},{"comuna":"Santa Cruz","promedioIDI":68.95,"longitud":-71.4019190205,"latitud":-34.6428770399,"region":"O'Higgins"},{"comuna":"Santa Juana","promedioIDI":70.67,"longitud":-72.9600558162,"latitud":-37.276684235,"region":"Biobío"},{"comuna":"Santa María","promedioIDI":61.8,"longitud":-70.6097026593,"latitud":-32.6860179782,"region":"Valparaíso"},{"comuna":"Santiago","promedioIDI":210.5,"longitud":-70.6569543965,"latitud":-33.4537511827,"region":"Metropolitana"},{"comuna":"Santo Domingo","promedioIDI":53.94,"longitud":-71.6765110141,"latitud":-33.8094452936,"region":"Valparaíso"},{"comuna":"Sierra Gorda","promedioIDI":22.27,"longitud":-69.3055670988,"latitud":-23.256414364,"region":"Antofagasta"},{"comuna":"Talagante","promedioIDI":84.52,"longitud":-70.8954488379,"latitud":-33.6820001145,"region":"Metropolitana"},{"comuna":"Talca","promedioIDI":88.01,"longitud":-71.6021975979,"latitud":-35.4278227385,"region":"Maule"},{"comuna":"Talcahuano","promedioIDI":96.37,"longitud":-73.099437088,"latitud":-36.7154060838,"region":"Biobío"},{"comuna":"Taltal","promedioIDI":69.53,"longitud":-69.8652040215,"latitud":-25.3133031739,"region":"Antofagasta"},{"comuna":"Temuco","promedioIDI":90.35,"longitud":-72.6677671889,"latitud":-38.6732629809,"region":"La Araucanía"},{"comuna":"Teno","promedioIDI":60.85,"longitud":-71.0218393344,"latitud":-34.8881484883,"region":"Maule"},{"comuna":"Teodoro Schmidt","promedioIDI":62.38,"longitud":-73.1274865658,"latitud":-39.0054863987,"region":"La Araucanía"},{"comuna":"Tierra Amarilla","promedioIDI":88.21,"longitud":-69.670693015,"latitud":-27.8635434,"region":"Atacama"},{"comuna":"Tiltil","promedioIDI":100.54,"longitud":-70.8761884235,"latitud":-33.0627155535,"region":"Metropolitana"},{"comuna":"Timaukel","promedioIDI":14.14,"longitud":-69.5343339111,"latitud":-54.2016999018,"region":"Magallanes"},{"comuna":"Tirúa","promedioIDI":88.91,"longitud":-73.3944052784,"latitud":-38.2972005966,"region":"Biobío"},{"comuna":"Tocopilla","promedioIDI":98.11,"longitud":-70.0212244558,"latitud":-21.9975710847,"region":"Antofagasta"},{"comuna":"Toltén","promedioIDI":54.88,"longitud":-73.065775374,"latitud":-39.2169624514,"region":"La Araucanía"},{"comuna":"Tomé","promedioIDI":80.06,"longitud":-72.8580501099,"latitud":-36.6166323796,"region":"Biobío"},{"comuna":"Torres del Paine","promedioIDI":9.66,"longitud":-72.8137769353,"latitud":-51.0402982921,"region":"Magallanes"},{"comuna":"Tortel","promedioIDI":110.42,"longitud":-74.1672029134,"latitud":-48.0279268652,"region":"Aysén"},{"comuna":"Traiguén","promedioIDI":72.48,"longitud":-72.6549810073,"latitud":-38.2469164278,"region":"La Araucanía"},{"comuna":"Treguaco","promedioIDI":50.13,"longitud":-72.6597876752,"latitud":-36.428007033,"region":"Ñuble"},{"comuna":"Tucapel","promedioIDI":52.54,"longitud":-71.7443488027,"latitud":-37.2254433905,"region":"Biobío"},{"comuna":"Valdivia","promedioIDI":84.03,"longitud":-73.1746908864,"latitud":-39.8177863595,"region":"Los Ríos"},{"comuna":"Vallenar","promedioIDI":77.84,"longitud":-70.6017299627,"latitud":-28.5932109853,"region":"Atacama"},{"comuna":"Valparaíso","promedioIDI":130.04,"longitud":-71.7533398553,"latitud":-32.9978836561,"region":"Valparaíso"},{"comuna":"Vichuquén","promedioIDI":63.34,"longitud":-72.0225310265,"latitud":-34.8413117915,"region":"Maule"},{"comuna":"Victoria","promedioIDI":86.94,"longitud":-72.2335936461,"latitud":-38.2806140753,"region":"La Araucanía"},{"comuna":"Vicuña","promedioIDI":82.24,"longitud":-70.3814578309,"latitud":-29.8918931309,"region":"Coquimbo"},{"comuna":"Vilcún","promedioIDI":67.31,"longitud":-72.116504654,"latitud":-38.7047212019,"region":"La Araucanía"},{"comuna":"Villa Alegre","promedioIDI":67.35,"longitud":-71.6829346305,"latitud":-35.6855606614,"region":"Maule"},{"comuna":"Villa Alemana","promedioIDI":71.92,"longitud":-71.330163502,"latitud":-33.0675667576,"region":"Valparaíso"},{"comuna":"Villarrica","promedioIDI":82.32,"longitud":-72.1828309674,"latitud":-39.3008669518,"region":"La Araucanía"},{"comuna":"Vitacura","promedioIDI":71.26,"longitud":-70.5731304191,"latitud":-33.3795435948,"region":"Metropolitana"},{"comuna":"Viña del Mar","promedioIDI":91.66,"longitud":-71.5154312157,"latitud":-33.0288002963,"region":"Valparaíso"},{"comuna":"Yerbas Buenas","promedioIDI":52.86,"longitud":-71.5441161205,"latitud":-35.6892237484,"region":"Maule"},{"comuna":"Yumbel","promedioIDI":60.83,"longitud":-72.616051762,"latitud":-37.0883437947,"region":"Biobío"},{"comuna":"Yungay","promedioIDI":63.57,"longitud":-71.9305829323,"latitud":-37.1046699113,"region":"Ñuble"},{"comuna":"Zapallar","promedioIDI":67.68,"longitud":-71.3362776202,"latitud":-32.5874828078,"region":"Valparaíso"},{"comuna":"Ñiquén","promedioIDI":54.06,"longitud":-71.8979040739,"latitud":-36.3022964962,"region":"Ñuble"},{"comuna":"Ñuñoa","promedioIDI":93.82,"longitud":-70.5991274507,"latitud":-33.4580935513,"region":"Metropolitana"}]
      const regionalData = [{"region":"Tarapacá","anio":2022,"indice":238.5},{"region":"Arica y Parinacota","anio":2023,"indice":183.9},{"region":"Arica y Parinacota","anio":2022,"indice":176.3},{"region":"Tarapacá","anio":2023,"indice":170.3},{"region":"Arica y Parinacota","anio":2024,"indice":169.6},{"region":"Metropolitana","anio":2019,"indice":149.8},{"region":"Tarapacá","anio":2021,"indice":148.4},{"region":"Tarapacá","anio":2024,"indice":144.7},{"region":"Metropolitana","anio":2024,"indice":143.9},{"region":"Metropolitana","anio":2023,"indice":140.6},{"region":"Metropolitana","anio":2018,"indice":140.4},{"region":"Tarapacá","anio":2015,"indice":139.4},{"region":"Metropolitana","anio":2022,"indice":138.6},{"region":"Tarapacá","anio":2016,"indice":131.2},{"region":"Metropolitana","anio":2017,"indice":130.9},{"region":"Metropolitana","anio":2015,"indice":128.6},{"region":"Antofagasta","anio":2022,"indice":127.8},{"region":"Antofagasta","anio":2023,"indice":125.8},{"region":"Metropolitana","anio":2020,"indice":125.8},{"region":"Atacama","anio":2023,"indice":123.2},{"region":"Metropolitana","anio":2016,"indice":121.0},{"region":"Arica y Parinacota","anio":2021,"indice":120.5},{"region":"Antofagasta","anio":2024,"indice":120.1},{"region":"Tarapacá","anio":2019,"indice":118.6},{"region":"Arica y Parinacota","anio":2019,"indice":117.8},{"region":"Atacama","anio":2022,"indice":117.4},{"region":"Tarapacá","anio":2017,"indice":117.3},{"region":"Atacama","anio":2024,"indice":114.5},{"region":"Tarapacá","anio":2018,"indice":113.3},{"region":"Valparaíso","anio":2024,"indice":107.1},{"region":"Coquimbo","anio":2022,"indice":105.3},{"region":"Valparaíso","anio":2023,"indice":105.2},{"region":"Tarapacá","anio":2020,"indice":104.9},{"region":"Valparaíso","anio":2022,"indice":104.7},{"region":"Metropolitana","anio":2021,"indice":103.8},{"region":"Los Lagos","anio":2024,"indice":103.8},{"region":"Los Ríos","anio":2024,"indice":103.0},{"region":"Arica y Parinacota","anio":2016,"indice":102.8},{"region":"Coquimbo","anio":2023,"indice":101.3},{"region":"Arica y Parinacota","anio":2020,"indice":101.2},{"region":"Los Lagos","anio":2023,"indice":101.2},{"region":"Los Lagos","anio":2022,"indice":100.9},{"region":"Biobío","anio":2024,"indice":100.4},{"region":"Antofagasta","anio":2015,"indice":100.1},{"region":"Biobío","anio":2022,"indice":98.6},{"region":"O'Higgins","anio":2024,"indice":98.6},{"region":"Aysén","anio":2024,"indice":98.4},{"region":"Coquimbo","anio":2024,"indice":98.3},{"region":"Biobío","anio":2023,"indice":97.9},{"region":"Arica y Parinacota","anio":2018,"indice":97.5},{"region":"Atacama","anio":2019,"indice":97.0},{"region":"Antofagasta","anio":2018,"indice":95.6},{"region":"O'Higgins","anio":2023,"indice":94.9},{"region":"Maule","anio":2024,"indice":94.8},{"region":"Arica y Parinacota","anio":2015,"indice":94.4},{"region":"O'Higgins","anio":2022,"indice":94.2},{"region":"Antofagasta","anio":2016,"indice":93.7},{"region":"Antofagasta","anio":2021,"indice":93.3},{"region":"Antofagasta","anio":2017,"indice":93.3},{"region":"Arica y Parinacota","anio":2017,"indice":92.6},{"region":"Maule","anio":2023,"indice":92.1},{"region":"Antofagasta","anio":2019,"indice":92.0},{"region":"Atacama","anio":2021,"indice":91.4},{"region":"La Araucanía","anio":2024,"indice":91.3},{"region":"Antofagasta","anio":2020,"indice":91.0},{"region":"Maule","anio":2022,"indice":90.6},{"region":"Valparaíso","anio":2015,"indice":90.6},{"region":"Valparaíso","anio":2019,"indice":90.4},{"region":"Atacama","anio":2018,"indice":90.4},{"region":"Atacama","anio":2016,"indice":90.3},{"region":"La Araucanía","anio":2022,"indice":90.1},{"region":"Valparaíso","anio":2016,"indice":89.7},{"region":"La Araucanía","anio":2023,"indice":89.4},{"region":"Ñuble","anio":2022,"indice":89.0},{"region":"Biobío","anio":2015,"indice":88.8},{"region":"Aysén","anio":2023,"indice":87.8},{"region":"Valparaíso","anio":2018,"indice":87.3},{"region":"Biobío","anio":2016,"indice":86.7},{"region":"Valparaíso","anio":2017,"indice":86.1},{"region":"Aysén","anio":2015,"indice":85.7},{"region":"Los Lagos","anio":2021,"indice":85.7},{"region":"Atacama","anio":2020,"indice":84.8},{"region":"Biobío","anio":2019,"indice":84.7},{"region":"Los Ríos","anio":2022,"indice":84.5},{"region":"Biobío","anio":2018,"indice":83.7},{"region":"Los Ríos","anio":2023,"indice":83.5},{"region":"Atacama","anio":2017,"indice":83.2},{"region":"Los Lagos","anio":2019,"indice":82.7},{"region":"Biobío","anio":2017,"indice":82.2},{"region":"Aysén","anio":2021,"indice":81.9},{"region":"Coquimbo","anio":2018,"indice":81.8},{"region":"La Araucanía","anio":2021,"indice":80.9},{"region":"Ñuble","anio":2024,"indice":80.8},{"region":"Atacama","anio":2015,"indice":80.0},{"region":"Valparaíso","anio":2021,"indice":79.9},{"region":"Coquimbo","anio":2019,"indice":79.8},{"region":"Valparaíso","anio":2020,"indice":79.5},{"region":"Coquimbo","anio":2017,"indice":79.4},{"region":"Aysén","anio":2019,"indice":78.2},{"region":"Aysén","anio":2022,"indice":78.0},{"region":"Ñuble","anio":2023,"indice":77.3},{"region":"O'Higgins","anio":2019,"indice":77.2},{"region":"La Araucanía","anio":2019,"indice":77.0},{"region":"La Araucanía","anio":2018,"indice":76.6},{"region":"Coquimbo","anio":2020,"indice":76.1},{"region":"Los Lagos","anio":2015,"indice":76.1},{"region":"Biobío","anio":2021,"indice":75.6},{"region":"Coquimbo","anio":2021,"indice":75.6},{"region":"Aysén","anio":2020,"indice":75.5},{"region":"Los Lagos","anio":2018,"indice":74.4},{"region":"O'Higgins","anio":2021,"indice":74.0},{"region":"Los Lagos","anio":2020,"indice":73.7},{"region":"La Araucanía","anio":2020,"indice":73.5},{"region":"Aysén","anio":2017,"indice":73.4},{"region":"La Araucanía","anio":2015,"indice":73.4},{"region":"O'Higgins","anio":2018,"indice":73.2},{"region":"O'Higgins","anio":2015,"indice":73.1},{"region":"La Araucanía","anio":2016,"indice":72.9},{"region":"Maule","anio":2019,"indice":72.8},{"region":"O'Higgins","anio":2020,"indice":72.8},{"region":"Coquimbo","anio":2016,"indice":72.6},{"region":"Los Lagos","anio":2016,"indice":72.5},{"region":"Coquimbo","anio":2015,"indice":72.2},{"region":"Los Ríos","anio":2019,"indice":71.9},{"region":"La Araucanía","anio":2017,"indice":71.5},{"region":"O'Higgins","anio":2017,"indice":71.3},{"region":"Magallanes","anio":2022,"indice":70.6},{"region":"Aysén","anio":2018,"indice":69.9},{"region":"Biobío","anio":2020,"indice":69.6},{"region":"Los Ríos","anio":2015,"indice":69.5},{"region":"Aysén","anio":2016,"indice":69.5},{"region":"Los Ríos","anio":2021,"indice":69.4},{"region":"Maule","anio":2020,"indice":69.0},{"region":"Los Lagos","anio":2017,"indice":68.9},{"region":"Los Ríos","anio":2020,"indice":68.8},{"region":"Maule","anio":2021,"indice":68.8},{"region":"Los Ríos","anio":2018,"indice":68.5},{"region":"O'Higgins","anio":2016,"indice":68.4},{"region":"Maule","anio":2018,"indice":67.7},{"region":"Los Ríos","anio":2017,"indice":67.6},{"region":"Los Ríos","anio":2016,"indice":67.6},{"region":"Magallanes","anio":2024,"indice":66.1},{"region":"Ñuble","anio":2021,"indice":64.8},{"region":"Magallanes","anio":2023,"indice":64.7},{"region":"Ñuble","anio":2019,"indice":64.7},{"region":"Ñuble","anio":2018,"indice":63.4},{"region":"Ñuble","anio":2017,"indice":63.1},{"region":"Maule","anio":2017,"indice":62.1},{"region":"Ñuble","anio":2016,"indice":60.3},{"region":"Maule","anio":2016,"indice":58.6},{"region":"Magallanes","anio":2021,"indice":58.5},{"region":"Maule","anio":2015,"indice":58.5},{"region":"Ñuble","anio":2015,"indice":58.4},{"region":"Ñuble","anio":2020,"indice":58.3},{"region":"Magallanes","anio":2019,"indice":58.0},{"region":"Magallanes","anio":2016,"indice":55.6},{"region":"Magallanes","anio":2017,"indice":54.8},{"region":"Magallanes","anio":2018,"indice":53.8},{"region":"Magallanes","anio":2015,"indice":51.7},{"region":"Magallanes","anio":2020,"indice":48.4}]
    </script>



    <script>
      const anios_completos = [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024];
      const REGIONES = ["Arica y Parinacota", "Tarapacá", "Antofagasta", "Atacama", "Coquimbo", "Valparaíso", "Metropolitana", "O'Higgins", "Maule", "Ñuble", "Biobío", "La Araucanía", "Los Ríos", "Los Lagos", "Aysén", "Magallanes"];
       


      let processedGeoJson = null;
      let activeMapType = 'marker'; // 'marker' or 'choropleth'
      let analysisRegionChartInstance = null;
      let analysisComunasChartInstance = null;

      const regionCenters = {
        "Tarapacá": { lat: -20.2, lon: -69.3, zoom: 7 },
        "Metropolitana": { lat: -33.45, lon: -70.6, zoom: 8.5 },
        "Arica y Parinacota": { lat: -18.5, lon: -69.6, zoom: 7.5 },
        "Antofagasta": { lat: -23.6, lon: -69.5, zoom: 6.5 },
        "Atacama": { lat: -27.3, lon: -70.1, zoom: 7 },
        "Valparaíso": { lat: -32.9, lon: -71.2, zoom: 8 },
        "Coquimbo": { lat: -29.9, lon: -70.9, zoom: 7.5 },
        "Biobío": { lat: -37.4, lon: -72.3, zoom: 7.5 },
        "Los Lagos": { lat: -41.5, lon: -72.9, zoom: 7 },
        "O'Higgins": { lat: -34.4, lon: -71.0, zoom: 8 },
        "Aysén": { lat: -45.4, lon: -73.0, zoom: 6 },
        "La Araucanía": { lat: -38.7, lon: -72.4, zoom: 7.5 },
        "Los Ríos": { lat: -39.8, lon: -72.6, zoom: 8 },
        "Maule": { lat: -35.4, lon: -71.6, zoom: 7.5 },
        "Ñuble": { lat: -36.6, lon: -71.9, zoom: 8 },
        "Magallanes": { lat: -53.2, lon: -70.0, zoom: 5.5 },
      };

      const unique_regions_for_js = [
        ...new Set(merged_commune_data_for_js.map((x) => x.region)),
      ].sort();

      const commonChartOptions = (moreOptions = {}) => ({
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: "bottom", labels: { font: { family: "'Inter', sans-serif", size: 12 }, usePointStyle: true, boxWidth: 8 } },
          tooltip: {
            enabled: true,
            backgroundColor: 'rgba(10, 35, 66, 0.9)', // var(--dark-blue)
            titleFont: { weight: 'bold', family: "'Inter', sans-serif", size: 14 },
            bodyFont: { family: "'Inter', sans-serif", size: 12 },
            padding: 12,
            displayColors: false,
            cornerRadius: 8,
            bodySpacing: 4,
          },
        },
        scales: {
            y: { grid: { color: "rgba(0,0,0,0.05)", drawBorder: false }, ticks: { font: { size: 11 } } },
            x: { grid: { display: false, drawBorder: false }, ticks: { font: { size: 11 } } },
        },
        ...moreOptions,
      });

      const chartColors = {
        darkBlue: "#0A2342", midBlue: "#2C5D63", teal: "#2CA58D", lightGreen: "#B9E28C",
        yellow: "#F4D35E", red: "#d9464f", lightBlue: "#89C2D9",
      };

      // Ponderadores Chart
      const ponderadoresData = {
        labels: ["Homicidios", "Delitos Sexuales", "Robos Violentos", "Armas", "VIF", "Drogas"],
        datasets: [{
          label: "Ponderador de Severidad",
          data: [1000, 200, 150, 75, 40, 30],
          backgroundColor: [chartColors.red, chartColors.darkBlue, chartColors.midBlue, chartColors.teal, chartColors.lightGreen, chartColors.yellow],
          borderColor: chartColors.cardBg, borderWidth: 4, hoverOffset: 8,
        }],
      };
      new Chart(document.getElementById("ponderadoresChart"), {
        type: "doughnut", data: ponderadoresData,
        options: { ...commonChartOptions(), cutout: "60%", plugins: { legend: { position: "right" } } }
      });

      // Tendencia Regional Chart
      const datasetsTendencia = ['Tarapacá', 'Metropolitana', 'Antofagasta', 'Magallanes'].map((region, index) => ({
        label: region,
        data: anios_completos.map(anio => regionalData.find(d => d.region === region && d.anio === anio)?.indice),
        borderColor: [chartColors.red, chartColors.darkBlue, chartColors.teal, chartColors.lightGreen][index],
        backgroundColor: [chartColors.red, chartColors.darkBlue, chartColors.teal, chartColors.lightGreen][index],
        tension: 0.4, fill: false, borderWidth: 3, pointRadius: 4, pointHoverRadius: 7,
      }));
      new Chart(document.getElementById("tendenciaRegionalChart"), {
        type: "line", data: { labels: anios_completos, datasets: datasetsTendencia },
        options: commonChartOptions({ scales: { y: { beginAtZero: false, title: { display: true, text: "IDI (Base 100)" } } } })
      });

      // Ranking Regional Chart
      const promedioRegionalData = REGIONES.map(region => {
        const regionDataFiltered = regionalData.filter(d => d.region === region);
        const promedio = regionDataFiltered.reduce((acc, curr) => acc + curr.indice, 0) / regionDataFiltered.length;
        return { region, promedio };
      }).sort((a, b) => b.promedio - a.promedio);

      new Chart(document.getElementById("rankingRegionalChart"), {
        type: "bar",
        data: {
          labels: promedioRegionalData.map((d) => d.region.replace("Arica y Parinacota", "Arica y P.")),
          datasets: [{
            label: "IDI Promedio (2015-2024)",
            data: promedioRegionalData.map((d) => d.promedio),
            backgroundColor: promedioRegionalData.map((d) => d.promedio > 100 ? chartColors.red : chartColors.teal),
            borderRadius: 6, barThickness: 12,
          }],
        },
        options: { ...commonChartOptions({ indexAxis: "y", plugins: { legend: { display: false } } }), scales: { x: { title: { display: true, text: "IDI Promedio" } } } }
      });

      // Populate tables
      const topComunas = [...merged_commune_data_for_js].sort((a, b) => b.promedioIDI - a.promedioIDI).slice(0, 10);
      const bottomComunas = [...merged_commune_data_for_js].sort((a, b) => a.promedioIDI - b.promedioIDI).slice(0, 10);
      document.getElementById("topComunasTable").innerHTML = topComunas.map(c => `<tr><td class="font-medium text-text-primary">${c.comuna}</td><td class="text-right font-bold text-red-600">${c.promedioIDI.toFixed(1)}</td></tr>`).join('');
      document.getElementById("bottomComunasTable").innerHTML = bottomComunas.map(c => `<tr><td class="font-medium text-text-primary">${c.comuna}</td><td class="text-right font-bold text-teal-600">${c.promedioIDI.toFixed(1)}</td></tr>`).join('');

      // Map functionality
      const getCommuneGroup = (idi) => {
        if (idi > 200) return { name: "Críticos", color: chartColors.red };
        if (idi >= 150) return { name: "Alta Preocupación", color: chartColors.darkBlue };
        if (idi >= 100) return { name: "Moderados", color: chartColors.midBlue };
        if (idi >= 50) return { name: "Menor Riesgo", color: chartColors.teal };
        return { name: "Baja Incidencia", color: chartColors.lightGreen };
      };

      const drawMarkerMap = (selectedRegion) => {
        const viewType = document.getElementById("mapViewSelect").value;
        let filteredCommunes = selectedRegion && selectedRegion !== "all" ? merged_commune_data_for_js.filter(d => d.region === selectedRegion) : merged_commune_data_for_js;
        
        let markerColors, showColorbar, hoverText;
        if (viewType === "groups") {
          markerColors = filteredCommunes.map(d => getCommuneGroup(d.promedioIDI).color);
          showColorbar = false;
          hoverText = filteredCommunes.map(d => `${d.comuna}<br>Grupo: ${getCommuneGroup(d.promedioIDI).name}<br>IDI: ${d.promedioIDI.toFixed(1)}`);
          document.getElementById("mapLegend").classList.remove("hidden");
        } else {
          markerColors = filteredCommunes.map(d => d.promedioIDI);
          showColorbar = true;
          hoverText = filteredCommunes.map(d => `${d.comuna}<br>IDI Promedio: ${d.promedioIDI.toFixed(1)}`);
          document.getElementById("mapLegend").classList.add("hidden");
        }

        const mapData = [{
            type: "scattermapbox",
            lat: filteredCommunes.map(d => d.latitud),
            lon: filteredCommunes.map(d => d.longitud),
            mode: "markers", text: hoverText, hoverinfo: "text",
            marker: {
              size: 10, opacity: 0.8,
              color: markerColors,
              colorscale: [[0, chartColors.lightGreen], [0.25, chartColors.teal], [0.5, chartColors.yellow], [0.75, chartColors.midBlue], [1, chartColors.red]],
              //cmin: 0, cmax: 300,
              cmin: 0, cmax: 200,
              colorbar: { title: "IDI", titleside: "right", len: 0.6, thickness: 15 },
              showscale: showColorbar,
            },
        }];

        let center = { lat: -38, lon: -71 }; let zoom = 3.5;
        if (selectedRegion !== "all" && regionCenters[selectedRegion]) {
          center = { lat: regionCenters[selectedRegion].lat, lon: regionCenters[selectedRegion].lon };
          zoom = regionCenters[selectedRegion].zoom;
        }

        const mapLayout = {
          mapbox: { style: "carto-positron", center: center, zoom: zoom },
          margin: { l: 0, r: 0, t: 0, b: 0 },
          paper_bgcolor: "rgba(0,0,0,0)",
        };

        Plotly.newPlot("markerMap", mapData, mapLayout, { displayModeBar: false, responsive: true });
      };

      const drawChoroplethMap = (selectedRegion) => {
        if (!processedGeoJson) {
            console.error("GeoJSON no está cargado aún.");
            document.getElementById("choroplethMap").innerHTML = '<p class="text-center p-8">Cargando geometrías...</p>';
            return;
        }

        let geojsonToDraw = JSON.parse(JSON.stringify(processedGeoJson)); // Deep copy

        if (selectedRegion && selectedRegion !== "all") {
            geojsonToDraw.features = geojsonToDraw.features.filter(f => f.properties.region === selectedRegion);
        }

        const mapData = [{
            type: "choroplethmapbox",
            geojson: geojsonToDraw,
            locations: geojsonToDraw.features.map(f => f.id),
            z: geojsonToDraw.features.map(f => f.properties.promedioIDI),
            featureidkey: "id",
            colorscale: [[0, chartColors.lightGreen], [0.25, chartColors.teal], [0.5, chartColors.yellow], [0.75, chartColors.midBlue], [1, chartColors.red]],
            //zmin: 0, zmax: 300,
            zmin: 0, zmax: 200,
            marker: { opacity: 0.7, line: { width: 0.5, color: '#fff' } },
            colorbar: { title: "IDI", titleside: "right", len: 0.6, thickness: 15 },
            hovertemplate: '<b>%{customdata.comuna}</b><br>IDI: %{z:.1f}<br>Región: %{customdata.region}<extra></extra>',
            customdata: geojsonToDraw.features.map(f => f.properties)
        }];

        let center = { lat: -38, lon: -71 }; let zoom = 3.5;
        if (selectedRegion !== "all" && regionCenters[selectedRegion]) {
          center = { lat: regionCenters[selectedRegion].lat, lon: regionCenters[selectedRegion].lon };
          zoom = regionCenters[selectedRegion].zoom;
        }

        const mapLayout = {
          mapbox: { style: "carto-positron", center: center, zoom: zoom },
          margin: { l: 0, r: 0, t: 0, b: 0 },
          paper_bgcolor: "rgba(0,0,0,0)",
        };

        Plotly.newPlot("choroplethMap", mapData, mapLayout, { displayModeBar: false, responsive: true });
        document.getElementById("mapLegend").classList.add("hidden");
        document.getElementById("mapViewSelect").disabled = true;
      }
      
      const updateActiveMap = () => {
          const selectedRegion = document.getElementById("regionMapSelect").value;
          if (activeMapType === 'marker') {
              document.getElementById("markerMap").classList.remove('hidden');
              document.getElementById("choroplethMap").classList.add('hidden');
              document.getElementById("mapViewSelect").disabled = false;
              drawMarkerMap(selectedRegion);
          } else {
              document.getElementById("markerMap").classList.add('hidden');
              document.getElementById("choroplethMap").classList.remove('hidden');
              drawChoroplethMap(selectedRegion);
          }
      };

      const mapViewSelect = document.getElementById("mapViewSelect");
      const regionMapSelect = document.getElementById("regionMapSelect");
      
      unique_regions_for_js.forEach(region => {
        const option = document.createElement("option");
        option.value = region; option.textContent = region;
        regionMapSelect.appendChild(option.cloneNode(true));
        document.getElementById("regionSelect").appendChild(option);
      });
      
      fetch('Comunas_simpli_GeoJson_Chile (1).json')
        .then(response => { if (!response.ok) { throw new Error('Network response was not ok'); } return response.json(); })
        .then(geojson => {
            geojson.features.forEach(feature => {
                const communeName = feature.properties.Nom_com;
                const communeData = merged_commune_data_for_js.find(c => c.comuna === communeName);
                feature.id = communeName;
                if (communeData) {
                    feature.properties.promedioIDI = communeData.promedioIDI;
                    feature.properties.region = communeData.region;
                    feature.properties.comuna = communeData.comuna;
                } else {
                    feature.properties.promedioIDI = null;
                    feature.properties.region = 'N/A';
                    feature.properties.comuna = communeName;
                }
            });
            processedGeoJson = geojson;
            if(activeMapType === 'choropleth') { updateActiveMap(); }
        })
        .catch(error => {
            console.error('Error loading or processing GeoJSON:', error);
            document.getElementById("choroplethMap").innerHTML = '<p class="text-center p-8 text-red-600">Error al cargar las geometrías del mapa.</p>';
        });

      document.addEventListener("DOMContentLoaded", () => { updateActiveMap(); });

      mapViewSelect.addEventListener("change", updateActiveMap);
      regionMapSelect.addEventListener("change", updateActiveMap);
      
      document.getElementById('markerMapTab').addEventListener('click', () => {
          activeMapType = 'marker';
          document.getElementById('markerMapTab').classList.add('active');
          document.getElementById('choroplethMapTab').classList.remove('active');
          updateActiveMap();
      });
      document.getElementById('choroplethMapTab').addEventListener('click', () => {
          activeMapType = 'choropleth';
          document.getElementById('markerMapTab').classList.remove('active');
          document.getElementById('choroplethMapTab').classList.add('active');
          updateActiveMap();
      });
      
      // AI Analysis
      document.getElementById("generateAnalysisBtn").addEventListener("click", () => {
        const selectedRegion = document.getElementById("regionSelect").value;
        const analysisOutput = document.getElementById("analysisOutput");
        analysisOutput.innerHTML = `<p class="text-center text-text-secondary animate-pulse">Generando análisis para ${selectedRegion}...</p>`;
        
        // Destroy previous charts if they exist
        if (analysisRegionChartInstance) { analysisRegionChartInstance.destroy(); }
        if (analysisComunasChartInstance) { analysisComunasChartInstance.destroy(); }

        setTimeout(() => {
          // --- Data Prep for Charts ---
          // 1. Regional Evolution Data
          let evolutionData = regionalData.filter(d => d.region === selectedRegion);
          
          // 2. Communes Highlights Data
          const regionCommunes = merged_commune_data_for_js
              .filter(d => d.region === selectedRegion)
              .sort((a,b) => a.promedioIDI - b.promedioIDI);
          const topN = 3;
          const bottomN = 3;
          const highlightedCommunes = [...regionCommunes.slice(0, bottomN), ...regionCommunes.slice(-topN)].sort((a,b) => b.promedioIDI - a.promedioIDI);

          // --- Generate HTML ---
          const regionData = promedioRegionalData.find(r => r.region === selectedRegion);
          const regionAvg = regionData ? regionData.promedio : 100;
          const situation = regionAvg > 120 ? "muy compleja" : regionAvg > 90 ? "desafiante" : "relativamente controlada";
          
          analysisOutput.innerHTML = `
            <div class="space-y-6 text-left">
                <div>
                    <h4 class="text-lg font-bold text-text-primary mb-1">Análisis de Seguridad: ${selectedRegion}</h4>
                    <p class="text-text-secondary">La región de ${selectedRegion} presenta un IDI promedio de <strong>${regionAvg.toFixed(1)}</strong>, indicando una situación de seguridad <strong>${situation}</strong>. El análisis detallado revela las siguientes tendencias y puntos de interés:</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h5 class="font-bold text-center text-text-primary mb-2">Evolución del IDI en ${selectedRegion} (2015-2024)</h5>
                        <div class="chart-container-ai"><canvas id="analysisRegionChart"></canvas></div>
                    </div>
                    <div>
                        <h5 class="font-bold text-center text-text-primary mb-2">Comunas Destacadas en ${selectedRegion}</h5>
                        <div class="chart-container-ai"><canvas id="analysisComunasChart"></canvas></div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-bold text-text-primary mb-2 mt-4">Recomendaciones Estratégicas</h4>
                    <ul class="list-disc list-inside space-y-2">
                        <li class="text-text-secondary"><strong class="text-mid-blue">Vigilancia Focalizada:</strong> Incrementar patrullajes en comunas con IDI consistentemente alto, como se observa en el gráfico de comunas.</li>
                        <li class="text-text-secondary"><strong class="text-mid-blue">Prevención Social:</strong> Desarrollar programas para jóvenes en riesgo, especialmente en áreas urbanas con tendencia al alza.</li>
                        <li class="text-text-secondary"><strong class="text-mid-blue">Intervención Basada en Evidencia:</strong> Utilizar la tendencia histórica del IDI para anticipar necesidades de recursos y planificar operativos.</li>
                    </ul>
                </div>
                <p class="text-xs text-gray-400 pt-3 italic">Nota: Este es un análisis simulado generado por IA con fines demostrativos.</p>
            </div>`;

          // --- Create New Charts ---
          // Chart 1: Regional Evolution
          
          //evolutionData = evolutionData.sort(x => x.anio);
          evolutionData = evolutionData.sort((a, b) => a.anio - b.anio);

          console.log("evo",evolutionData)
          analysisRegionChartInstance = new Chart(document.getElementById('analysisRegionChart'), {
              type: 'line',
              data: {
                  labels: evolutionData.map(d => d.anio),
                  datasets: [{
                      label: `IDI de ${selectedRegion}`,
                      data: evolutionData.map(d => d.indice),
                      borderColor: chartColors.darkBlue,
                      backgroundColor: 'rgba(10, 35, 66, 0.1)',
                      fill: true,
                      tension: 0.3,
                      borderWidth: 2
                  }]
              },
              options: commonChartOptions({ plugins: { legend: { display: false } }})
          });

          // Chart 2: Commune Highlights
          analysisComunasChartInstance = new Chart(document.getElementById('analysisComunasChart'), {
              type: 'bar',
              data: {
                  labels: highlightedCommunes.map(c => c.comuna),
                  datasets: [{
                      label: 'IDI Promedio',
                      data: highlightedCommunes.map(c => c.promedioIDI),
                      backgroundColor: highlightedCommunes.map(c => c.promedioIDI > 100 ? chartColors.red : chartColors.teal),
                      borderRadius: 4,
                  }]
              },
              options: commonChartOptions({ indexAxis: 'y', plugins: { legend: { display: false } }, scales: { x: { title: { display: true, text: "IDI Promedio" } } } })
          });

        }, 1200);
      });
    </script>
</body>
</html>